---
title: Petal System との連携とログ設計
updated: 2025-06-29
tags: [Petal System, ログ設計, 詩幣記録, 署名, リリフォン連携]
description: 詩的観測ログの記録・署名機構としての Petal System と、UIレイヤー・トークン管理との統合設計について解説する
---

# Petal System 統合仕様

この文書では、星辰詩語システムにおける観測記録・詩幣評価・詩的通知の正当性を担保する「🌸Petal System」の統合ポイントを示します。

---

## 🌸 Petal System の役割

Petal System（ペタル・システム）は、以下の中核機能を担います：

- **詩語・感情ベクトル・署名の観測ログ記録**
- **詩幣の発行根拠としての定量評価記録**
- **通信ログ（ユーザー発言・AI通知）の真正性検証**
- **長期的記録保存のためのアーカイブ機能**

---

## 🔗 統合モジュールと接続点

| モジュール           | Petalとの接続内容                                      |
|----------------------|--------------------------------------------------------|
| 観測者AI              | 詩語・応答・詩幣使用の記録送信                            |
| 軽量AI                | ユーザー発言（予約・送信済み）と通知ログの記録            |
| 詩幣エンジン           | 発行／消費イベントをトリガーとして署名記録を作成            |
| リリフォンUI          | ログ保存完了通知、ログのトレーサビリティ表示                 |

---

## 🖋️ ログ形式と署名仕様

- すべてのログは **JSON Lines（.jsonl）** 形式で保存される。
- 各エントリには以下が含まれる：

```json
{
  "statement_id": "stmt_xxxx",
  "user_id": "user001",
  "content": "観測者AIへ：この詩幣のゆくえを知りたい。",
  "timestamp": "2025-06-26T23:56:56.449622",
  "visibility": "limited",
  "urgency": "high",
  "sentiment": "neutral",
  "status": "queued",
  "hash": "<SHA256_hex>",
  "signature": "<Ed25519_encoded_signature>"
}
